unit PresentationLauncher;

interface

uses

  Forms,
  PresentationConfigurator,
  SysUtils,
  Classes;

type

  TPresentationLauncher = class

    private

      FPresentationConfigurator: TPresentationConfigurator;

      procedure Initialize;
      procedure Configure;
      procedure Run;

    public

      destructor Destroy; override;

      constructor Create(PresentationConfigurator: TPresentationConfigurator);

      procedure Launch;

  end;

implementation

uses

  BaseFuelCharacteristicsAccountingSystemFormController;

{ TPresentationLauncher }

procedure TPresentationLauncher.Configure;
begin

  Application.MainFormOnTaskBar := True;

  FPresentationConfigurator.Configure;

end;

constructor TPresentationLauncher.Create(
  PresentationConfigurator: TPresentationConfigurator);
begin

  inherited Create;

  FPresentationConfigurator := PresentationConfigurator;

end;

destructor TPresentationLauncher.Destroy;
begin

  FreeAndNil(FPresentationConfigurator);
  inherited;

end;

procedure TPresentationLauncher.Initialize;
begin

  Application.Initialize;

end;

procedure TPresentationLauncher.Launch;
begin

  try

    Initialize;
    Configure;
    Run;

  except

    on e: Exception do begin

      Application.Terminate;

    end;

  end;

end;

procedure TPresentationLauncher.Run;
var FuelCharacteristicsAccountingSystemFormController:
      TBaseFuelCharacteristicsAccountingSystemFormController;
begin

  FuelCharacteristicsAccountingSystemFormController :=
    TBaseFuelCharacteristicsAccountingSystemFormController(
      FPresentationConfigurator.Controllers[
        TBaseFuelCharacteristicsAccountingSystemFormController.ClassName
      ]
    );

  FuelCharacteristicsAccountingSystemFormController.ShowFormAsModal(Application);

  Application.Run;

end;

end.
