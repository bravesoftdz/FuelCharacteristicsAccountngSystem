unit StubEmployeesAdministrationReferenceFormController;

interface

uses

  BaseEmployeesAdministrationReferenceFormController,
  Event,
  AbstractFormController,
  ReferenceFormViewModel,
  EventBus,
  FuelCharacteristicsAccountingSystemFormControllerEvents,
  SysUtils,
  Classes;

type

  TStubEmployeesAdministrationReferenceFormController =
    class (TBaseEmployeesAdministrationReferenceFormController)

      protected

        function CreateReferenceFormViewModel: TReferenceFormViewModel; override;

        procedure SubscribeOnEvents(EventBus: IEventBus); override;

      protected

        procedure OnEmployeeRoleNamesRequestedEventHandler(
          Sender: TObject;
          var EmployeeRoleNames: TStrings
        ); override;

      protected

        procedure OnFuelCharacteristicsAccountingSystemAdministrationFormRequestedEventHandler(
          Event: TFuelCharacteristicsAccountingSystemAdministrationFormRequestedEvent
        );

      public

        procedure Handle(Event: TEvent); override;

    end;


implementation

uses

  EmployeesAdministrationReferenceRecordViewModel,
  EmployeesAdministrationReferenceFormViewModel;
  

{ TStubEmployeesAdministrationReferenceFormController }

function TStubEmployeesAdministrationReferenceFormController.CreateReferenceFormViewModel: TReferenceFormViewModel;
begin

  Result := TEmployeesReferenceAdministrationFormViewModel;
  
end;

procedure TStubEmployeesAdministrationReferenceFormController.Handle(
  Event: TEvent);
begin
  inherited;

end;

procedure TStubEmployeesAdministrationReferenceFormController.
  OnEmployeeRoleNamesRequestedEventHandler(
    Sender: TObject;
    var EmployeeRoleNames: TStrings
  );
begin

  inherited;

  // refactor: from dto in the future

  EmployeeRoleNames.Add('Авиатехник');
  EmployeeRoleNames.Add('Бухгалтер');
  EmployeeRoleNames.Add('Начальник склада');
  
end;

procedure TStubEmployeesAdministrationReferenceFormController.
  OnFuelCharacteristicsAccountingSystemAdministrationFormRequestedEventHandler(
    Event: TFuelCharacteristicsAccountingSystemAdministrationFormRequestedEvent
  );
begin

  ShowFormAsModal(TForm);
end;

procedure TStubEmployeesAdministrationReferenceFormController.SubscribeOnEvents(
  EventBus: IEventBus);
begin

  inherited;

  EventBus.RegisterEventHandler(
    TFuelCharacteristicsAccountingSystemAdministrationFormRequestedEvent,
    Self
  );
  
end;

end.
